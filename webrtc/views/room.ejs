<!DOCTYPE html>
<html lang="en">
<head>
  <title>Piano++ Chatroom<%= rid %></title>
  <% include _header %>
<style>
  @import "compass/css3";

@import url(http://fonts.googleapis.com/css?family=Pirata+One);

$ebony : #171C1A;
$ivory: white;
* {box-sizing: border-box;}

body {
  @include background(linear-gradient( top, white, gainsboro 100%));
  background-size: cover;
}  
audio { display: block; margin-bottom: 1rem; } 
h1,h2  { 

  color: rgb(100,100,100);
  line-height: 1.2; 
  margin: 0 0 1rem; 
  text-shadow : 0 2px 4px rgba(black, 0.25);
   b {
   color: rgb(100,0,0);
    text-shadow: 0px 1px 5px #CCC;
  }
}
h1 { 
    font-family: 'Pirata One', cursive;

  font-size: 3rem;
}
.page {
  margin: 30px auto;
  text-align: center;
  width: 75%;
  overflow: hidden;
}
ol { 
  position: relative; 
  padding: 0; 
  margin: 0 0 10px; 
  display: inline-block;
  //float: left;
  font-size: 0; // to get rid of spaces between keys. ugly, I know.
}
li{
  font-size: 16px;
  font-size: 1rem;
  @include background(linear-gradient( top, #C0C1BD, #F0F0F0 10%, linen));  
  transition: all 0.1s ease-in-out; //  just a little animation

  padding: 0; 
  margin: 0;
  display: inline-block;
  border: 1px solid #ccc;
  padding: 220px 15px 50px;
  border-radius: 0 0 5px 5px;
  box-shadow: 0 5px 5px #aaa;

  position: relative;
  z-index: 1;
  cursor: pointer;

  color: transparent;
  &:hover {
    color: #C0C1BD;
    
  }
  &:active{
    box-shadow: none;
    top: 5px;
    color: #333;
  }
  &.ebony {
    /* build the key shape */
    z-index: 2;
    position: absolute;
    width: 32px;
    top: 0px;
    margin-left: -16px; // align the ebony keys
    padding: 130px 0px 10px;

    /* Typography */
    text-align: center;
    font-size: 0.66667rem;
    color: transparent;
   
    
    border-radius: 0 0 2px 2px;
    border-width: 0 6px 12px;
    border-color: #000;
    border-bottom-color: #424546;
    background: $ebony;
    @include background( linear-gradient(#5F6265, #151B19 25%, $ebony));
    box-shadow: 0 3px 5px #ccc, inset 0px 0px 0px 1px rgba(gainsboro,0.2);
    
    &:hover {
        color: gainsboro;
    }
    
    &:active {
      @include background( linear-gradient(#5F6265, #151B19 50%, $ebony)); 
      border-bottom-width: 8px;
      padding-top: 135px;
      color: $ivory;
    }
  }
}
  
</style>
</head>
<body>

<div class="container">

  <div id="streams_container">
    <div class="streamContainer" id="myPublisherContainer">
      <div id="myPublisher"></div>
    </div>
  </div>
    
    
   
<div class="page">
<ol class="scale-1">
  <li data-note="c" >C</li>
  <li data-note="cs" class="ebony">C# D♭</li>
  <li data-note="d">D</li>
  <li data-note="ds" class="ebony">D# E♭</li>
  <li data-note="e">E</li>
  <li data-note="f">F</li>
  <li data-note="fs" class="ebony">F# G♭</li>
  <li data-note="g">G</li>
  <li data-note="gs" class="ebony">G# A♭</li>
  <li data-note="a">A</li>
  <li data-note="as" class="ebony">A# B♭</li>
  <li data-note="b">B</li>
</ol> 
  
<ol class="scale-2">
  <li data-note="c">C</li>
  <li data-note="cs" class="ebony">C# D♭</li>
  <li data-note="d">D</li>
  <li data-note="ds" class="ebony">D# E♭</li>
  <li data-note="e">E</li>
  <li data-note="f">F</li>
  <li data-note="fs" class="ebony">F# G♭</li>
  <li data-note="g">G</li>
  <li data-note="gs" class="ebony">G# A♭</li>
  <li data-note="a">A</li>
  <li data-note="as" class="ebony">A# B♭</li>
  <li data-note="b">B</li>
</ol>
<!-- ol class="scale-3">
  <li data-note="c">C</li>
  <li data-note="cs" class="ebony">C# D♭</li>
  <li data-note="d">D</li>
  <li data-note="ds" class="ebony">D# E♭</li>
  <li data-note="e">E</li>
  <li data-note="f">F</li>
  <li data-note="fs" class="ebony">F# G♭</li>
  <li data-note="g">G</li>
  <li data-note="gs" class="ebony">G# A♭</li>
  <li data-note="a">A</li>
  <li data-note="as" class="ebony">A# B</li>
  <li data-note="b">B</li>
</ol -->
</div>

<!-- Original mp3 files from http://www.vibrationdata.com/piano.htm -->

C <audio id="mid-c" preload="auto" controls>
  <source src="https://dl.dropbox.com/u/37434025/PianoTones/piano_middle_C.mp3"></source>
</audio>
C# <audio preload="auto" id="mid-c-sharp" controls>
  <source src="https://dl.dropbox.com/u/37434025/PianoTones/piano_C_sharp.mp3"></source>
</audio>
D <audio preload="auto" id="mid-d" controls>
  <source src="https://dl.dropbox.com/u/37434025/PianoTones/piano_D.mp3"></source>
</audio>
D# <audio preload="auto" id="mid-d-sharp" controls>
  <source src="https://dl.dropbox.com/u/37434025/PianoTones/piano_D_sharp.mp3"></source>
</audio>
E <audio preload="auto" id="mid-e" controls>
  <source src="https://dl.dropbox.com/u/37434025/PianoTones/piano_E.mp3"></source>
</audio>
F <audio preload="auto" id="mid-f" controls>
  <source src="https://dl.dropbox.com/u/37434025/PianoTones/piano_F.mp3"></source>
</audio>
F# <audio preload="auto" id="mid-f-sharp" controls>
  <source src="https://dl.dropbox.com/u/37434025/PianoTones/piano_F_sharp.mp3"></source>
</audio>
G <audio preload="auto" id="mid-g" controls>
  <source src="https://dl.dropbox.com/u/37434025/PianoTones/piano_G.mp3"></source>
</audio>
G#<audio preload="auto" id="mid-g-sharp" controls>
  <source src="https://dl.dropbox.com/u/37434025/PianoTones/piano_G_sharp.mp3"></source>
</audio>
A <audio preload="auto" id="mid-a" controls>
  <source src="https://dl.dropbox.com/u/37434025/PianoTones/piano_A.mp3"></source>
</audio>
A# <audio preload="auto" id="mid-a-sharp" controls>
  <source src="https://dl.dropbox.com/u/37434025/PianoTones/piano_A_sharp.mp3"></source>
</audio>
B <audio preload="auto" id="mid-b" controls>
  <source src="https://dl.dropbox.com/u/37434025/PianoTones/piano_B.mp3"></source>
</audio>
        

  <div id="controlsContainer">
    <div class="controlsBody">
      <div id="controlOptions" class="optionContainer">
        <a href="http://tokbox.com/?utm_source=opentokrtc&amp;utm_medium=web&amp;utm_campaign=webrtc" id="opentokLogo" target="_blank">
      <img src="/img/piano.gif" alt="opentok transparent logo">
    </a>
    <div id="controlOptionsRight">
      <a href= "mailto:song@tokbox.com?subject=OpenTokRTC%20Feedback" id="mailButton" data-tooltip-title="Send Feedback!" class="controlOption option">
      </a>
      <div id="filtersButton" data-tooltip-title = "Filters" class="controlOption option popover-dismiss" data-toggle="popover" data-placement="top" data-html="true" title="Filters" data-content="<ul id='filtersList'><li><button data-value='Sepia' type='button'>Sepia</button></li><li><button data-value='Invert' type='button'>Inverted</button></li><li><button data-value='Grayscale' type='button'>Grayscale</button></li><li><button data-value='Blur' type='button'>Blur</button></li><li><button data-value='None' type='button'>None</button></li></ul>"></div>
      <div id="roomLinkButton" data-tooltip-title="Share Room Link!" title="Share Room Link!" class="controlOption option popover-dismiss" data-placement="top"  data-activity="roomLink">
      </div>
      <div id="recordButton" data-tooltip-title="Start Recording" class="controlOption option"data-activity="record">
      </div>
      <div id="chatButton" data-tooltip-title="Text Chat" class="controlOption option no-after" data-activity="chat">
      </div>
      </div>
    </div>
      </div>
    </div>
  </div>
</div>

<script id = "chattrBaseTpl" type = "text/x-handlebars-template">
  <div id = 'chattr'> 
    <div id ='relative_wrapper'>
      <div id='chat_header' class='chat-header' > 
        <div><span></span><span></span><span></span></div> 
        <h4 id='roomId'></h4> 
      </div> 
      <div class='inner-chat'> 
        <p id = 'displayHelp'> Type /help for a list of commands 
        <ul id='messages'> 
        </ul> 
      </div> 
      <div class='chat-input-wrapper'> 
        <input type='text' id='chatInput' placeholder= 'Write here...'  /> 
      </div> 
    </div>
  </div>
</script>
<script id = "chattrChatTpl" type="text/x-handlebars-template">
  <li class="chat {{cls}}">
  <label>{{nickname}}</label>
  <p data-date="{{date}}" title="{{time}}">{{message}}</p>
</script>
<script id="chattrStatusTpl" type="text/x-handlebars-template">
  <li class = 'status'>
    <p><span class='oldName'>{{oldName}}</span> is now known as <span class='newName'>{{newName}}</span></p>
  </li>
</script>
<script id="chattrNewUserTpl" type="text/x-handlebars-template">
  <li class= "status newUser">
    <p><span>{{nickname}}</span> has joined the room</p>
  </li>
</script>
<script id="chattrUserLeaveTpl" type="text/x-handlebars-template">
  <li class= "status newUser">
    <p><span>{{nickname}}</span> has left the room</p>
  </li>
</script>
<script id="chattrUpdateTpl" type="text/x-handlebars-template">
  <li class="status {{cls}}">
  {{{text}}}
  </li>
</script>
<script id="chattrUserListTpl" type="text/x-handlebars-template">
  <p class='userList'>Users in this room right now</p>
  {{#users}}
  <p class = "userList {{last}}">- {{name}}</p>
  {{/users}}
</script>
<script id="chattrHelpTpl" type="text/x-handlebars-template">
  <p>Type <span>/name your_name</span> to change your display name</p> 
  <p>Type <span>/list</span> to see a list of users in the room</p> 
  <p>Type <span>/focus</span> to focus the room on yourself</p>
  <p>Type <span>/unfocus</span> to take focus away from any focussed people in the room</p>
  <p class='last'>Type <span>/help</span> to see a list of commands</p>
</script>
<script id="chattrNameExistsTpl" type="text/x-handlebars-template">
  <p>User <span>{{newName}}</span> already exists. Please choose another name.</p>
</script>
<script id="chattrFocusTpl" type="text/x-handlebars-template">
  <li class="status">
    <p>User <span>{{nick}}</span> now has focus.</p>
  </li>
</script>
<script id="chattrUnfocusTpl" type="text/x-handlebars-template">
  <li class="status">
    <p>Focus has been removed.</p>
  </li>
</script>


<script id="userStreamTemplate" type="text/x-handlebars-template">
  <div class="streamContainer {{id}}" data-connectionid="{{connectionId}}">
    <div id="{{id}}"></div>
    <div class="flagUser" data-streamconnection="{{id}}">Remove User</div>
  </div>
</script>

<% include _vendor %>
<link rel="stylesheet" href="/css/room.css" />
<link rel="stylesheet" href="/css/OpenTokChattr.css" />
<script src="//static.opentok.com/v2.2/js/opentok.min.js"></script>
<script src="/vendors/handlebars.js" type="text/javascript"></script>
<script src="/js/layoutContainer.js" type="text/javascript"></script>
<script src="/vendors/jquery.event.ue.js" type="text/javascript"></script>
<script src="/vendors/jquery.udraggable.js" type="text/javascript"></script>
<script src="/vendors/ZeroClipboard/ZeroClipboard.min.js" type="text/javascript"></script>
<script src="/js/OpenTokChattr.js" type="text/javascript"></script>
<script src="/js/piano.js" type="text/javascript"></script>
<script src="/js/timer.js" type="text/javascript"></script>


<script src="/js/room.js" type="text/javascript"></script>
<script type="text/javascript">
  var session = OT.initSession( "<%= apiKey %>", "<%= sid %>" );
  chattr = new OpenTokChattr("body","<%= rid %>",session,
 {"draggable": true,
  "startPosition":{
    x: startX,
    y: startY
  },
  "closeable": function(){
    $("#chattr").hide();
    $("#chatButton").removeClass("selected");
  }
 });
  room = new Room("<%= rid %>", session, "<%= token %>", chattr);
  var startX = $(window).width()-10-$("#chattr").width();
  var startY = $(window).height()-56-$("#chattr").height();
  $('#filtersButton').popover();
  $(".controlOption").each(function(){
    $(this).tooltip({
      title: $(this).data("tooltip-title"),
      placement: "top"
    });
  });
  $('body').on('click', function (e) {
    $('.popover-dismiss').each(function () {
        //the 'is' for buttons that trigger popups
        //the 'has' for icons within a button that triggers a popup
        if (!$(this).is(e.target) && $(this).has(e.target).length === 0 && $('.popover').has(e.target).length === 0) {
            $(this).popover('hide');
            $(this).removeClass('selected');
        }
    });
  });
  $("#roomLinkButton").popover({
    title: $(this).attr("title"),
    content: "<input id='roomLinkInput' type='text' value='"+window.location.origin+"/<%= rid %>' ><button id='copyButton'>Copy</button>",
    html: true
  });
  $("#roomLinkButton").on('shown.bs.popover', function(){
    var client = new ZeroClipboard($("#copyButton"));
    client.on("ready", function(readyEvent){
      client.on("copy", function(event){
        var clipboard = event.clipboardData;
        clipboard.setData( "text/plain", window.location.origin+"/<%= rid %>" );
      });
      client.on("aftercopy", function(event){
        $("#copyButton").html("Copied!");
      });
    });
  });
  $(".controlOption").click(function(){
    $(this).toggleClass("selected");
  });
</script>

<% include _analytics %>

</body>
</html>
